#############
# Automatically generated by generator.py in splunk/security-content
# On Date: {{ time }} UTC
# Author: Splunk Security Research
# Contact: research@splunk.com
#############

### STORIES ###

{% for story in stories %}
[analytic_story://{{ story.name }}]
category = {{ story.category[0] }}
last_updated = {{ story.modification_date }}
version = {{ story.version }}
references = {{ story.references | tojson }}
maintainers = {{ story.maintainers | tojson }}
spec_version = {{ story.spec_version }}
searches = {{ story.searches | tojson }}
description = {{ story.description }}
{% if story.narrative is defined %}
narrative = {{ story.narrative }}
{% endif %}

{% endfor %}
### END STORIES ###

### DETECTIONS ###

{% for detection in detections %}
[savedsearch://ESCU - {{ detection.name }} - Rule]
type = detection
asset_type = {{ detection.asset_type }}
confidence = {{ detection.confidence }}
explanation = {{ detection.eli5 }}
how_to_implement = {{ detection.how_to_implement }}
annotations = {{ detection.mappings | tojson }}
known_false_positives = {{ detection.known_false_positives }}
providing_technologies = {{ detection.data_metadata.providing_technologies | tojson }}

{% endfor %}
### END DETECTIONS ###

### INVESTIGATIONS ###

{% for investigation in investigations %}
[savedsearch://ESCU - {{ investigation.name }}]
type = investigation
explanation = none
how_to_implement = {{ investigation.how_to_implement }}
{% if investigation.known_false_positives is defined %}
known_false_positives = {{ investigation.known_false_positives }}
{% else %}
known_false_positives = None at this time
{% endif %}
{% if investigation.investigate.splunk is defined %}
earliest_time_offset = {{ investigation.investigate.splunk.schedule.earliest_time }}
latest_time_offset = {{ investigation.investigate.splunk.schedule.latest_time }}
{% else %}
earliest_time_offset = {{ investigation.investigate.phantom.schedule.earliest_time }}
latest_time_offset = {{ investigation.investigate.phantom.schedule.latest_time }}
{% endif %}

{% endfor %}
### END INVESTIGATIONS ###

### BASELINES ###
{% for baseline in baselines %}
[savedsearch://ESCU - {{ baseline.name }}]
type = support
explanation = {{ baseline.eli5 }}
how_to_implement = {{ baseline.how_to_implement }}
known_false_positives = {{ baseline.known_false_positives }}
providing_technologies = {{ baseline.data_metadata.providing_technologies | tojson }}

{% endfor %}
### END ESCU BASELINES ###
